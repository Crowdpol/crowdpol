<template name="ProposalsList">
	{{#if currentUser}}
	<!-- MDL Tab Container -->
	<div class="mdl-tabs mdl-js-tabs mdl-js-ripple-effect">
		<!-- Tab Bars -->
		<div class="mdl-tabs__tab-bar">
			<a href="#vote-proposals-panel" id="vote-proposals-tab" class="mdl-tabs__tab is-active">{{_ "pages.proposals.list.tabs.allProposals"}}</a>
			<a href="#my-proposals-panel" id="my-proposals-tab" class="mdl-tabs__tab">{{_ "pages.proposals.list.tabs.myProposals"}}</a>
			<a href="/proposals/edit" class="mdl-tabs__tab">{{_ "pages.proposals.list.tabs.writeProposals"}}</a>
		</div>

		<div class="app-container" id="proposal-list-container">
			<div class="search-input">
				<!--<input class="" type="text"  id="proposal-search"> <i class="material-icons">search</i>-->
				<label><i class="material-icons search-icon">search</i></label>
				<input type="text" placeholder="Search.." id="proposal-search">
			</div>

			<!-- MDL tab panels, is-active to denote currently active -->
			<div class="mdl-tabs__panel is-active" id="vote-proposals-panel">
				<button class="add-new-proposal mdl-button mdl-js-button mdl-button--fab" id="add-new-proposal">
					<i class="material-icons">add</i>
				</button>
				<div class="switch-wrap">
					<label class="switch proposal-switch mdl-switch mdl-js-switch mdl-js-ripple-effect" for="open-closed-switch">
						<input type="checkbox" id="open-closed-switch" class="mdl-switch__input" checked>
						<span class="mdl-switch__label">{{_ "pages.proposals.list.openClosedSwitch"}}</span>
					</label>
				</div>

				{{#if Template.subscriptionsReady}}
					{{#if openSelected}}
						<h4>{{_ "pages.proposals.list.headings.openProposals"}}</h4>
						<ul class="demo-list-control mdl-list">
							{{#each openProposals}}
								{{> ProposalCard}}
							{{/each}}
						</ul>
					{{else}}
						<h4>{{_ "pages.proposals.list.headings.closedProposals"}}</h4>
						<ul class="demo-list-control mdl-list">
							{{#each closedProposals}}
								{{> ProposalCard}}
							{{/each}}
						</ul>
					{{/if}}

				{{else}}
					{{> loader}}
				{{/if}}
			</div>

			<!-- MDL Tab panel 2 -->
			<div class="mdl-tabs__panel" id="my-proposals-panel">
				<button class="add-new-proposal mdl-button mdl-js-button mdl-button--fab" id="add-new-proposal">
					<i class="material-icons">add</i>
				</button>

				{{#if Template.subscriptionsReady}}
					<div class="switch-wrap">
						<label class="switch proposal-switch mdl-switch mdl-js-switch mdl-js-ripple-effect" for="author-invited-switch">
							<input type="checkbox" id="author-invited-switch" class="mdl-switch__input" checked>
							<span class="mdl-switch__label">{{_ "pages.proposals.list.createdInvitedSwitch"}}</span>
						</label>
					</div>

					{{#if authorSelected}}
						<h4>{{_ "pages.proposals.list.headings.myProposals"}}</h4>
						<ul class="demo-list-control mdl-list">
							{{#each myProposals}}
								{{> ProposalCard }}
							{{/each}}
						</ul>

					{{else}}
						<h4>{{_ "pages.proposals.list.headings.notMyProposals"}}</h4>
						<ul class="demo-list-control mdl-list">
							{{#each invitedProposals}}
								{{> ProposalCard }}
							{{/each}}
						</ul>
					{{/if}}

				{{else}}
					{{> loader}}
				{{/if}}
			</div>
		</div>
	</div>
	{{/if}}
</template>

<template name="ProposalCard">
	<a href="/proposals/view/{{_id}}" class="proposal-list-item-link">
	<li class="proposal-item mdl-list__item">
		<div class="card-main-wrap">
			<span class="card-main mdl-list__item-primary-content">
				<h6>
					{{ title this}}
					{{#if userIsAuthor _id}}
						<button class="mdl-button mdl-js-button mdl-button--icon delete-proposal-button" data-proposal-id="{{_id}}">
						  <i class="material-icons delete-proposal-icon" data-proposal-id="{{_id}}">delete</i>
						</button>
					{{/if}}
				</h6>
				
			</span> 
			<span class="mdl-list__item-secondary-action">
				{{#if isDraft this}}
					<small class="proposal-date">
						<i class="material-icons">edit</i>&nbsp;{{ lastModified }}
					</small>
				{{else}}
					<small class="proposal-date">
						<i class="material-icons">date_range</i>&nbsp;{{ startDate }}&nbsp;-&nbsp;{{ endDate }}&nbsp;
					</small>
				{{/if}}
			</span>
		</div>
		<div class="card-secondary-wrap">
			<p class="proposal-abstract">{{ abstract this}}</p>
		</div>

			<div class="mdl-card__actions">
				{{#if hasVotes _id}}
					<span class="proposal-percentage-text-left"> {{_ "pages.voting.for"}} {{ yesPercentage _id }}% </span>
					<span class="proposal-percentage-text-right"> {{_ "pages.voting.against"}} {{ noPercentage _id }}% </span>
					<div class="proposal-vote-progress-bar">
					  <div class="proposal-vote-yes-bar" style="width:{{ yesPercentage _id }}%"></div>
				  	</div>
				  	{{else}}
						<small class="proposal-percentage-text-left"> {{_ "pages.voting.no-votes-used"}} </small>
					{{/if}}
					
		  	</div>
		
		<!-- <a href="/proposals/view/{{_id}}" class="secondary-button proposal-card-button mdl-button mdl-js-button mdl-js-ripple-effect">
			{{_ "proposals.list.cards.read"}}&nbsp;{{#if canVote}}{{_ "proposals.list.cards.vote"}}{{/if}}
		</a> -->
	</li>
</a>
</template>
