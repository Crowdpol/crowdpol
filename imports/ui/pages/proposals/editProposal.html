<template name='EditProposal' >
	{{#if currentUser}}
	{{#if Template.subscriptionsReady}}

	{{> backButton text="generic.back-to-proposals" url="/dash"}}
	<!-- Include Quill stylesheet -->
	<link href="https://cdn.quilljs.com/1.0.0/quill.snow.css" rel="stylesheet">

	<div class="app-container">
		<h3>{{_ "pages.proposals.edit.heading"}}</h3>

		<!-- Proposal Form -->
		<form id="edit-proposal-form">

			<!-- Tabs for translations -->
			<div class="mdl-tabs mdl-js-tabs mdl-js-ripple-effect">
				<div class="mdl-tabs__tab-bar">
					{{#each languages}}
					<a href="#{{this}}-panel" class="mdl-tabs__tab {{activeClass this}}">{{this}}</a>
					{{/each}}
				</div>

				{{#each languages}}
				<div class="mdl-tabs__panel {{activeClass this}}" id="{{this}}-panel">

					{{> ProposalForm content=proposalContent language=this }}

				</div>
				{{/each}}
			</div>

			<!-- Non-Translated Content -->

			<!-- Start and end dates -->
			<div class="small-inputs-wrap">
				<div class="input-wrap mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
					<label class="mdl-textfield__label">{{_ "pages.proposals.edit.startDate"}}</label>
					<input type="date" name="startDate" id="startDate" class="mdl-textfield__input">
				</div>

				<div class="input-wrap mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
					<label class="mdl-textfield__label">{{_ "pages.proposals.edit.endDate"}}</label>
					<input type="date" name="endDate" id="endDate" class="mdl-textfield__input">
				</div>
			</div>

			<!-- Tags -->
			<!-- {{> taggle }} -->

			<!-- TAGS SHOULD BE MOVED TO ITS OWN COMPONENT -->
			<div class="input-wrap mdl-textfield mdl-js-textfield mdl-textfield--floating-label getmdl-select getmdl-select__fix-height">
				<input class="mdl-textfield__input" type="text" name="add-tag" id="add-tag">
				<label for="add-tag" class="mdl-textfield__label">Add some tags</label>

				<ul for="add-tag" class="mdl-menu mdl-menu--bottom-left mdl-js-menu">
					<li class="mdl-menu__item dropdown-item">choose</li>
					<li class="mdl-menu__item dropdown-item">from the</li>
					<li class="mdl-menu__item dropdown-item">list</li>
				</ul>
			</div>
			<div class="tags-wrap add-tags-wrap">
				<!-- THESE CAN BE REMOVED WHEN CLIKED ON THEM -->
				<a class="tag tag-chip">These are</a>
				<a class="tag tag-chip">the tags</a>
				<a class="tag tag-chip">i added</a>
			</div>
			<!-- END TAGS SHOULD BE MOVED TO ITS OWN COMPONENT -->

			<!-- User invitation field -->
			<div class="form-group">
				{{> UserSearch}}
			</div>
			<div class="form-group">
				<div id="invited-users">
					{{#each selectedInvites}}
					<span class="mdl-chip mdl-chip--contact mdl-chip--deletable">
						<img class="mdl-chip__contact" src="{{profile.photo}}">
						<span class="mdl-chip__text">{{profile.firstName}}&nbsp;{{profile.lastName}}</span>
						<a href="#" class="mdl-chip__action remove-invite" data-user-id="{{_id}}"><i class="material-icons">cancel</i></a>
					</span>
					{{/each}}
				</div>
				<div id="invited-users-email">
					{{#each value in emailedInvites}}
					<span class="mdl-chip mdl-chip--contact">
						<span class="mdl-chip__contact mdl-color--teal mdl-color-text--white"><i class="material-icons email-invites">mail</i></span>
						<span class="mdl-chip__text">{{value}}</span>
						<a href="#" class="mdl-chip__action remove-invite-email" data-array-index="{{@index}}"><i class="material-icons">cancel</i></a>
					</span>
					{{/each}}
				</div>
			</div>
			<br>

			<!-- Save and Preview buttons -->
			<div class="form-group">
				<input type="submit" id="save-proposal" class="primary-button mdl-button mdl-js-button mdl-js-ripple-effect mdl-button--raised" value='{{_ "form.save-draft"}}'>
				<input id="preview-proposal" class="secondary-button mdl-button mdl-js-button mdl-js-ripple-effect" value='{{_ "generic.preview"}}'>
			</div>
		</form>

	</div>

	<!-- Toast to show autosave progress -->
	<div id="autosave-toast-container" class="mdl-js-snackbar mdl-snackbar">
		<div class="mdl-snackbar__text"></div>
		<button class="mdl-snackbar__action" type="button"></button>
	</div>

	{{/if}}
	{{/if}}

</template>

<template name='ProposalForm'>

		<!-- Title -->
		<div class="input-wrap mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
			<label class="mdl-textfield__label">{{_ "pages.proposals.edit.title"}}</label>
			<input type="text" name="title" id="title-{{language}}" class="mdl-textfield__input">
		</div>

		<!-- Abstract -->
		<div class="input-wrap mdl-textfield mdl-js-textfield mdl-textfield--floating-label">
			<textarea class="mdl-textfield__input" type="text" rows= "5" name="abstract" id="abstract-{{language}}"></textarea>
			<label class="mdl-textfield__label">{{_ "pages.proposals.edit.abstract"}}</label>
		</div>

		<!-- Body -->
		<small>{{_ "pages.proposals.edit.body"}}</small>

		<!-- Quill editor container -->
		<div id="body-editor-{{language}}"></div>
		<input type="hidden" name="body" id="body-{{language}}" class="mdl-textfield__input">
		<br/>

		<!-- Points for and against -->
		<div class="mdl-grid">
			<small>{{_ "pages.proposals.edit.forAndAgainst"}}</small>
			<div class="mdl-cell mdl-cell--6-col mdl-cell--6-col-tablet mdl-cell--12-col-phone">
				<!-- Points For -->
				<div class="input-wrap mdl-textfield mdl-js-textfield mdl-textfield--floating-label proposal-points" id="pointsForWrap">
					<label class="mdl-textfield__label" >{{_ "pages.proposals.edit.pointFor"}}</label>
					<textarea class="mdl-textfield__input" type="text" rows= "1" id="inputPointFor-{{language}}" name="inputPointFor"></textarea>
				</div>
				<button class="mdl-button mdl-js-button mdl-button--icon mdl-button--colored pointsButton add-point-for" id="add-point-for" data-lang="{{language}}" style="position: relative; bottom: 60px; float: right;">
					<i class="material-icons" data-lang="{{language}}">add</i>
				</button>
				<ul id="points-for-list-{{language}}" class="pointsList">
					{{#each pointsFor}}
					<li id="point-for-{{@index}}" class="pointsListItem">
						{{this}}
						<button class="mdl-button mdl-js-button mdl-button--icon mdl-button--colored pointsButton remove-point-for" id="remove-point-for" data-lang="{{language}}" data-id="{{@index}}" style="position: relative; float: right; display: none;">
							<i class="material-icons" data-lang="{{language}}">remove</i>
						</button>
					</li>
					<input type="hidden" class="point-for-hidden" id="point-for-{{@index}}-hidden" value={{this}}>
					{{/each}}
				</ul>
			</div>
			<!-- Points Against -->
			<div class="mdl-cell mdl-cell--6-col mdl-cell--6-col-tablet mdl-cell--12-col-phone">
				<div class="input-wrap mdl-textfield mdl-js-textfield mdl-textfield--floating-label" id="pointsAgainstWrap">
					<textarea class="mdl-textfield__input" type="text" rows= "1" id="inputPointAgainst-{{language}}" name="inputPointAgainst"></textarea>
					<label class="mdl-textfield__label" for="inputPointAgainst">{{_ "pages.proposals.edit.pointAgainst"}}</label>
				</div>
				<button class="mdl-button mdl-js-button mdl-button--icon mdl-button--colored pointsButton add-point-against" id="add-point-against" data-lang="{{language}}" style="position: relative; bottom: 60px; float: right;">
					<i class="material-icons" data-lang="{{language}}">add</i>
				</button>
				<ul id="points-against-list-{{language}}" class="pointsList">
					{{#each pointsAgainst}}
					<li  id="point-against-{{@index}}" class="pointsListItem">
						{{this}}
						<button class="mdl-button mdl-js-button mdl-button--icon mdl-button--colored pointsButton remove-point-against" id="remove-point-against" data-lang="{{language}}" style="position: relative; float: right; display: none;">
							<i class="material-icons" data-lang="{{language}}">remove</i>
						</button>
					</li>
					<input type="hidden" class="point-against-hidden" id="point-against-{{@index}}-hidden" value={{this}}>
					{{/each}}
				</ul>
			</div>

		</div>



</template>


