<template name="AdminFlags">
  {{> AdminFlagModal}}
  {{#if currentUserIsAdmin}}
	<div class="dashboard__item dashboard__item--full">
		<div class="card">
      <h2 class="mdl-card__title-text">{{_"admin.flags.heading"}}</h2>
			{{#if Template.subscriptionsReady}}
				<div class="mdl-tabs mdl-js-tabs mdl-js-ripple-effect">
					<div class="mdl-tabs__tab-bar">
							<a href="#reported-pending" class="mdl-tabs__tab is-active">Pending</a>
							<a href="#reported-resolved" class="mdl-tabs__tab">Resolved</a>
              <a href="#reported-all" class="mdl-tabs__tab">All</a>
					</div>
					<div class="mdl-tabs__panel is-active" id="reported-pending">
            <table class="mdl-data-table mdl-js-data-table mdl-data-table mdl-shadow--2dp">
    					<thead>
    						<tr>
                  <th>{{_"admin.flags.created"}}</th>
    							<th>{{_"admin.flags.reporter"}}</th>
    							<th>{{_"admin.flags.owner"}}</th>
    							<th>{{_"admin.flags.type"}}</th>
    							<th>{{_"admin.flags.view"}}</th>
    						</tr>
    					</thead>
    					<tbody>
                {{#each flag in pendingFlags}}
                  <tr>
                    <th>{{flagDate}}</th>
                    <th>{{>UserCard userId=flag.creatorId style="text"}}</th>
                    <th>{{>UserCard userId=flag.flaggerId style="text"}}</th>
                    <th>
                      {{flag.contentType}}
                    </th>
                    <th>
                      <button class="mdl-button mdl-js-button mdl-button--icon preview-flag" data-flag-id="{{flag._id}}">
                	      <i class="material-icons preview-flag" data-flag-id="{{flag._id}}">visibility</i>
                	    </button>
                    </th>
                  </tr>
                {{else}}
                  <tr>
                    <td colspan="5" align="center">Nope</td>
                  </tr>
                {{/each}}
              </tbody>
            </table>
          </div>
					<div class="mdl-tabs__panel" id="reported-resolved">
            <table class="mdl-data-table mdl-js-data-table mdl-data-table mdl-shadow--2dp">
    					<thead>
    						<tr>
                  <th>{{_"admin.flags.created"}}</th>
    							<th>{{_"admin.flags.reporter"}}</th>
    							<th>{{_"admin.flags.owner"}}</th>
    							<th>{{_"admin.flags.type"}}</th>
    							<th>{{_"admin.flags.view"}}</th>
    						</tr>
    					</thead>
    					<tbody>
                {{#each flag in resolvedFlags}}
                  <tr>
                    <th>{{flagDate}}</th>
                    <th>{{>UserCard userId=flag.creatorId style="text"}}</th>
                    <th>{{>UserCard userId=flag.flaggerId style="text"}}</th>
                    <th>
                      {{flag.contentType}}
                    </th>
                    <th>
                      <button class="mdl-button mdl-js-button mdl-button--icon preview-flag" data-flag-id="{{flag._id}}">
                	      <i class="material-icons preview-flag" data-flag-id="{{flag._id}}">visibility</i>
                	    </button>
                    </th>
                  </tr>
                {{else}}
                  <tr>
                    <td colspan="5" align="center">Nope</td>
                  </tr>
                {{/each}}
              </tbody>
            </table>
          </div>
          <div class="mdl-tabs__panel" id="reported-all">
            <table class="mdl-data-table mdl-js-data-table mdl-data-table mdl-shadow--2dp">
    					<thead>
    						<tr>
                  <th>{{_"admin.flags.created"}}</th>
    							<th>{{_"admin.flags.reporter"}}</th>
    							<th>{{_"admin.flags.owner"}}</th>
    							<th>{{_"admin.flags.type"}}</th>
                  <th>{{_"admin.flags.status"}}</th>
    							<th>{{_"admin.flags.view"}}</th>
    						</tr>
    					</thead>
    					<tbody>
                {{#each flag in allFlags}}
                  <tr>
                    <th>{{flagDate}}</th>
                    <th>{{>UserCard userId=flag.creatorId style="text"}}</th>
                    <th>{{>UserCard userId=flag.flaggerId style="text"}}</th>
                    <th>
                      {{flag.contentType}}
                    </th>
                    <th>
                      {{flag.status}}
                    </th>
                    <th>
                      <button class="mdl-button mdl-js-button mdl-button--icon preview-flag" data-flag-id="{{flag._id}}">
                	      <i class="material-icons preview-flag" data-flag-id="{{flag._id}}">visibility</i>
                	    </button>
                    </th>
                  </tr>
                {{else}}
                  <tr>
                    <td colspan="6" align="center">Nope</td>
                  </tr>
                {{/each}}
              </tbody>
            </table>
          </div>
        </div>
      {{/if}}
    </div>
  </div>
  {{/if}}
</template>

<template name="AdminFlagModal">
  <div id="overlay"></div>
	<div class="proposal-modal">
    Reported By:
      {{>UserCard userId=flag.flaggerId style="flat"}}
    <br>
    Date flagged: {{flag.createdAt}}
    <br>
    Reason: {{flag.category}}
    <br>
    Explanation: {{flag.other}}

    <hr>
    {{#if isProposal flag.contentType}}
      {{> ViewProposal proposalId=flag.contentId}}
    {{/if}}
    {{#if isComment flag.contentType}}
      this is comment
    {{/if}}
    {{#if isArgument flag.contentType}}
      this is argument
    {{/if}}
		{{#if proposalId}}
			{{> ViewProposal proposalId=proposalId}}
    {{/if}}
    <hr>
    1. Block content
    2. Flag content
    3. Warn owner
    4. Respond to flagger
    5. Take no action
	</div>
</template>
