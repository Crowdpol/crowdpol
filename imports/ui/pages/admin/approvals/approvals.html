<template name="AdminApprovals">
	{{#if currentUserIsAdmin}}
	<div class="container">
		<h3>{{_"admin.approvals.heading"}}</h3>
		{{#if Template.subscriptionsReady}}
			{{#if pendingApprovals.count}}
				<table class="mdl-data-table mdl-js-data-table mdl-data-table mdl-shadow--2dp">
					<thead>
						<tr>
							<th>Date</th>
							<th>Username</th>
							<th>
								{{_"admin.users.email"}}
							</th>
							<th>
								{{_"admin.users.roles"}}
							</th>
							<th>Request Type</th>
							<th>Request Status</th>
							<th></th>
							<th></th>
						</tr>
					</thead>
					<tbody>

					{{#each pendingApprovals}}
						{{#each approvals}}
							{{#if checkStatus status}}
							<tr>
								<td>{{createdAt}}</td>
								<td>{{../profile.username}}</td>
								<td>
									{{#each ../emails}}
										{{address}}
									{{/each}}
								</td>
								<td>{{../roles}}</td>
								<td class="mdl-data-table__cell--non-numeric">{{type}}</td>
								<td>{{status}}</td>
								<td>
									<button class="mdl-button mdl-js-button mdl-button--raised"
										data-email="{{../emails.[0].address}}" data-role="{{../roles.[0]}}" data-type="{{type}}" data-request-id="{{id}}"
										data-user-id="{{../_id}}" id="approve-button">
										<i class="material-icons">check</i>
										{{_'admin.approvals.approve-button'}}
									</button>
								</td>
								<td>
									<button class="mdl-button mdl-js-button mdl-button--raised"
										data-email="{{../emails.[0].address}}" data-role="{{../roles.[0]}}" data-type="{{type}}" data-request-id="{{id}}"
										data-user-id="{{../_id}}" id="reject-button">
										<i class="material-icons">close</i>
										{{_'admin.approvals.reject-button'}}
									</button>
								</td>
							</tr>
							{{/if}}
						{{/each}}
					{{/each}}
					</tbody>
				</table>
			{{else}}
				<p>There are no pending approval requests.</p>
			{{/if}}
		{{else}}
		<p>
			Loading...
		</p>
		{{/if}}
	</div>
	{{/if}}
</template>
